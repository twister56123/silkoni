---
import '../styles/global.css';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import { Button } from '@/components/ui/button';

// Import product images for Astro Image optimization
import pillowcasePink from '@/assets/products/pillowcase-pink.jpg';
import pillowcaseSage from '@/assets/products/pillowcase-sage.jpg';
import pillowcaseBlue from '@/assets/products/pillowcase-blue.jpg';
import pillowcaseIvory from '@/assets/products/pillowcase-ivory.jpg';
import turbanPink from '@/assets/products/turban-pink.jpg';
import turbanSage from '@/assets/products/turban-sage.jpg';
import turbanBlue from '@/assets/products/turban-blue.jpg';
import turbanIvory from '@/assets/products/turban-ivory.jpg';

// Map image filenames to imported images
const imageMap = {
  'pillowcase-pink.jpg': pillowcasePink,
  'pillowcase-sage.jpg': pillowcaseSage,
  'pillowcase-blue.jpg': pillowcaseBlue,
  'pillowcase-ivory.jpg': pillowcaseIvory,
  'turban-pink.jpg': turbanPink,
  'turban-sage.jpg': turbanSage,
  'turban-blue.jpg': turbanBlue,
  'turban-ivory.jpg': turbanIvory,
};

// Fetch and sort products by order
const products = await getCollection('products');
products.sort((a, b) => a.data.order - b.data.order);
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>SILKONI - Шовкові наволочки та тюрбани</title>
		</head>
	<body>
		<section id="products" class="py-16">
			<div class="max-w-7xl mx-auto px-4">
				<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
					{products.map(product => (
						<div class="bg-white rounded-lg shadow-md p-6">
							<h2 class="text-2xl font-bold mb-4">{product.data.name}</h2>
							<Image
								src={imageMap[product.data.images[0] as keyof typeof imageMap]}
								alt={product.data.name}
								widths={[375, 640, 768, 1024]}
								loading="lazy"
								class="w-full h-64 object-cover rounded-lg mb-4"
							/>
							<p class="text-xl font-semibold text-green-600 mb-2">
								{product.data.price} {product.data.currency}
							</p>
							<p class="text-gray-700 mb-4">{product.data.description}</p>
							<div class="mb-4">
								<h3 class="font-semibold mb-2">Доступні кольори:</h3>
								<ul class="flex gap-2 flex-wrap">
									{product.data.colors.map(color => (
										<li class="bg-gray-100 px-3 py-1 rounded-full text-sm">{color}</li>
									))}
								</ul>
							</div>
							<Button>Купити</Button>
						</div>
					))}
				</div>
			</div>
		</section>
	</body>
</html>
